(this.webpackJsonpbitmaster=this.webpackJsonpbitmaster||[]).push([[0],{33:function(e,t,n){e.exports={loader:"loader_loader__1_YZx"}},40:function(e,t,n){},46:function(e,t,n){},48:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n.n(c),a=n(19),s=n.n(a),o=(n(40),n(11)),u=n(14),i=n(34),j=n(8),M=n.n(j),d=n(23),l=n(6),b=.01;function O(e){var t=[{c:function(){return[e[0]-b*Math.random(),e[1]-b*Math.random()]}},{c:function(){return[e[0]+b*Math.random(),e[1]+b*Math.random()]}}];return t[Math.floor(Math.random()*t.length)].c()}var N=n(5),h="main/SET_COORDS",L="form/SET_SEARCH",x="main/SET_SEARCH_WITH_CLICK",w="form/NO_ADRESS",f="main/SET_CAR",y="main/SEARCH_CAR_STATUS",g="form/SET_ERROR",p={coords:[],inputSearch:"",noAdress:null,car:[],searchCarStatus:"",error:""};var v,z=function(e){return{type:h,body:e}},C=function(e){return{type:x,body:e}},m=function(e){return{type:w,body:e}},T=function(e){return{type:y,body:e}},D=M.a.mark(Y),S=M.a.mark(G),A=M.a.mark(Z),E=M.a.mark(U),I=M.a.mark(J);function k(e){return new Promise((function(t){v=setTimeout(t,e)}))}function Q(e){return P.apply(this,arguments)}function P(){return(P=Object(d.a)(M.a.mark((function e(t){return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return clearTimeout(v),e.next=3,k(t.del);case 3:return e.next=5,fetch("https://geocode-maps.yandex.ru/1.x/?format=json&apikey=505379b1-6f2a-446f-af46-102586018d6a&geocode=".concat(t.search)).then((function(e){return e.json()}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Y(){var e,t,n,c,r;return M.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(l.c)((function(e){return e.mainPage.inputSearch}));case 2:return e=a.sent,t={search:e,del:1e3},a.prev=4,a.next=7,Object(l.a)(Q,t);case 7:return n=a.sent,c=n.response.GeoObjectCollection.featureMember[0].GeoObject.Point.pos,r=c.split(/ /g).map((function(e){return Number(e)})),a.next=12,Object(l.b)(z(r.reverse()));case 12:a.next=18;break;case 14:return a.prev=14,a.t0=a.catch(4),a.next=18,Object(l.b)(m("\u0410\u0434\u0440\u0435\u0441 \u043d\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442"));case 18:case"end":return a.stop()}}),D,null,[[4,14]])}function G(e){var t,n,c,r,a;return M.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,Object(l.b)(z(e.data));case 2:return s.next=4,Object(l.c)((function(e){return e.mainPage.coords}));case 4:return t=s.sent,n="".concat(t[1],",").concat(t[0]),c={search:n,del:0},s.prev=7,s.next=10,Object(l.a)(Q,c);case 10:return r=s.sent,a=r.response.GeoObjectCollection.featureMember[0].GeoObject.metaDataProperty.GeocoderMetaData.text,s.next=14,Object(l.b)(C(a));case 14:s.next=20;break;case 16:return s.prev=16,s.t0=s.catch(7),s.next=20,Object(l.b)(m("\u0422\u0430\u043a\u043e\u0433\u043e \u0430\u0434\u0440\u0435\u0441\u0430 \u043d\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442"));case 20:case"end":return s.stop()}}),S,null,[[7,16]])}function _(){return H.apply(this,arguments)}function H(){return(H=Object(d.a)(M.a.mark((function e(){return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k(1500);case 2:return"http://localhost:5000/taxi/crews_info",e.next=5,fetch("http://localhost:5000/taxi/crews_info").then((function(e){return e.json()}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Z(){var e,t,n;return M.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,Object(l.b)(T(!0));case 2:return c.next=4,Object(l.a)(_);case 4:return e=c.sent,c.next=7,Object(l.c)((function(e){return e.mainPage.coords}));case 7:return t=c.sent,c.next=10,e.map((function(e){return e.coords_car=O(t),e}));case 10:return n=c.sent,c.next=13,Object(l.b)(T(!1));case 13:return c.next=15,Object(l.b)({type:f,body:n});case 15:case"end":return c.stop()}}),A)}function R(e){return K.apply(this,arguments)}function K(){return(K=Object(d.a)(M.a.mark((function e(t){var n,c;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=(n=(new Date).toLocaleString()).replace(/^(\d{2}).(\d{2}).(\d{4})/,"$3$2$1").replace(/,/g,"").replace(/\s/g,"").replace(/:/g,""),c={source_time:n,addresses:[{address:t.search,lat:t.lat,lon:t.lon}]},alert(JSON.stringify(c,null,2));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(e){var t,n,c;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(l.c)((function(e){return e.mainPage.inputSearch}));case 2:return t=e.sent,e.next=5,Object(l.c)((function(e){return e.mainPage.coords}));case 5:return n=e.sent,c={search:t,lat:n[0],lon:n[1]},e.next=9,Object(l.a)(R,c);case 9:case"end":return e.stop()}}),E)}function J(){return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(l.d)("SEARCH_CAR",Z);case 2:return e.next=4,Object(l.d)("GEO_CODE",Y);case 4:return e.next=6,Object(l.d)("CLICK_SEARCH_ADRESS",G);case 6:return e.next=8,Object(l.d)("form/POST_ORDER",U);case 8:case"end":return e.stop()}}),I)}var B=n(30),V=n.n(B),W=Object(u.c)({mainPage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case h:return Object(N.a)(Object(N.a)({},e),{},{coords:t.body,car:[],noAdress:null});case L:case x:return Object(N.a)(Object(N.a)({},e),{},{inputSearch:t.body});case w:return Object(N.a)(Object(N.a)({},e),{},{noAdress:t.body,car:[]});case y:return Object(N.a)(Object(N.a)({},e),{},{searchCarStatus:t.body});case f:return Object(N.a)(Object(N.a)({},e),{},{car:t.body});case g:return Object(N.a)(Object(N.a)({},e),{},{error:t.body});default:return e}}}),F=Object(i.a)(),X=Object(u.e)(W,Object(u.a)(F,V.a));F.run(J);var $=X,q=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,49)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,a=t.getLCP,s=t.getTTFB;n(e),c(e),r(e),a(e),s(e)}))},ee=n(16),te=(n(46),n(28)),ne=n(35),ce=n(24),re=n(3);function ae(e){var t;return e||(t="\u041e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u043b\u0435"),t}var se=function(e){var t,n=e.label,c=e.noAdress,r=Object(ne.a)(e,["label","noAdress"]),a=Object(ce.c)(r),s=Object(ee.a)(a,2),u=s[0],i=s[1];return Object(o.c)()((t=i.error,{type:g,body:t})),Object(re.jsxs)("div",{className:"textinput",children:[Object(re.jsx)("label",{children:n}),Object(re.jsx)("input",Object(N.a)(Object(N.a)({},u),r)),i.touched&&i.error?Object(re.jsx)("div",{className:"error",children:i.error}):null,c&&u.value?Object(re.jsx)("div",{className:"error",children:c}):null]})},oe=function(e){var t=e.search,n=e.setSearch,c=e.submit,r=e.noAdress,a=Object(o.c)(),s=function(e){return n(e.currentTarget.value)&&a({type:"GEO_CODE"})};return Object(re.jsx)(ce.b,{initialValues:{startPath:t},enableReinitialize:!0,onSubmit:function(e){return a({type:"form/POST_ORDER",body:e})},children:function(e){return Object(re.jsx)(ce.a,{onLoad:c(e.submitForm),children:Object(re.jsx)("div",{className:"rowInput",children:Object(re.jsx)(se,{noAdress:r,name:"startPath",type:"text",label:"\u041e\u0442\u043a\u0443\u0434\u0430",validate:ae,value:t,onChange:s})})})}})};function ue(e,t,n,c){var r=function(){switch(n){case"car":return{height:40,color:"#3ee55a",get width(){return.65*this.height},icon:'<svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x=\'60\' y=\'-100\'\n                viewBox="0 0 43.723 43.723" style="enable-background:new 0 0 43.723 43.723;" xml:space="preserve" width="200px">\n                <path style="fill:#030104;" d="M43.723,14.572h-6.166l-0.351,3.325c-0.129-0.078-0.261-0.153-0.397-0.222v-6.933\n                c0-3.091-2.514-5.605-5.605-5.605H12.518c-3.092,0-5.605,2.514-5.605,5.605v6.933c-0.138,0.067-0.271,0.144-0.397,0.222\n                l-0.351-3.325H0v3.177l6.199,0.354c-1.16,0.822-1.902,2.072-1.902,3.477v6.354c0,1.58,0.939,2.967,2.355,3.765v4.271\n                c0,1.443,1.68,2.616,3.749,2.616s3.749-1.172,3.749-2.616v-3.55h14.78v3.55c0,1.443,1.678,2.616,3.748,2.616\n                c2.071,0,3.748-1.172,3.748-2.616v-3.962c1.77-0.709,3-2.264,3-4.072v-6.354c0-1.404-0.744-2.654-1.903-3.477l6.2-0.354\n                L43.723,14.572L43.723,14.572z M9.154,10.742c0-1.855,1.509-3.364,3.362-3.364h18.687c1.854,0,3.364,1.509,3.364,3.364v6.365\n                c-0.096-0.005-0.188-0.013-0.283-0.013H9.438c-0.097,0-0.189,0.008-0.283,0.013L9.154,10.742L9.154,10.742z M28.027,25.317v1.494\n                H16.442v-1.494H28.027z M8.033,27.446v-4.913h6.766v4.913H8.033z M15.694,31.11c-0.519,0-0.937-0.418-0.937-0.936\n                c0-0.517,0.418-0.935,0.937-0.935c0.517,0,0.934,0.418,0.934,0.935S16.211,31.11,15.694,31.11z M28.961,31.11\n                c-0.517,0-0.934-0.418-0.934-0.936c0-0.517,0.417-0.935,0.934-0.935s0.936,0.418,0.936,0.935\n                C29.896,30.691,29.478,31.11,28.961,31.11z M36.623,27.446h-6.766v-4.913h6.766V27.446z" fill="black"/>\n                </svg>'};case"i":return{height:55,color:"yellow",get width(){return.65*this.height},icon:"<svg width='150px' x='60' y='-100' viewBox='0 0 350 350' style='enable-background:new 0 0 500 500'>\n                <path d='M291.299,116.517h-3.501c10.635-12.36,17.102-28.378,17.102-45.915C304.899,31.666,273.219,0,234.305,0 c-38.93,0-70.584,31.666-70.584,70.602c0,17.537,6.477,33.555,17.093,45.915h-3.51c-19.645,0-35.626,15.997-35.626,35.645v117.105 c0,19.648,15.982,35.633,35.626,35.633h1.372v128.07c0,20.332,10.697,35.645,24.884,35.645h61.468 c14.208,0,24.908-15.312,24.908-35.645v-128.07h1.363c19.642,0,35.639-15.984,35.639-35.633V152.161 C326.932,132.514,310.94,116.517,291.299,116.517z' fill='black'/>\n                </svg>"}}}(),a=[-r.width/2,-r.height],s=t.templateLayoutFactory.createClass("<svg width='".concat(r.width,"px' height='").concat(r.height,"' x='0' y='0' viewBox='0 0 325 500'>\n                  <g transform='translate(0.000000,512.000000) scale(0.100000,-0.100000)'\n                  fill='#000000'>\n                  <path d=\"M1319 5100 c-320 -57 -621 -214 -853 -446 -129 -128 -220 -255 -300\n                  -419 -119 -240 -166 -444 -166 -715 0 -271 47 -475 166 -715 81 -165 153 -265\n                  331 -457 171 -185 221 -245 347 -412 445 -594 717 -1254 743 -1804 3 -73 8\n                  -130 11 -127 2 2 8 64 13 137 33 510 234 1042 602 1592 148 222 306 417 553\n                  686 179 194 297 397 368 631 91 302 89 659 -5 955 -179 568 -669 994 -1256\n                  1094 -153 27 -404 26 -554 0z\" fill='").concat(r.color,"'/>\n                  </g>\n                  ").concat(r.icon,"\n                  </svg>")),o=new t.Placemark(c,{},{iconLayout:s,iconOffset:a});e.geoObjects.add(o)}var ie=n(33),je=n.n(ie),Me=function(){return Object(re.jsxs)("div",{className:je.a.loader,children:[Object(re.jsx)("div",{}),Object(re.jsx)("div",{})]})},de=function(e){var t=e.car_mark,n=e.car_model,c=e.car_color,r=e.distance;return Object(re.jsxs)("div",{className:"bodyCar",children:[Object(re.jsx)("div",{className:"iconCar",children:Object(re.jsx)("img",{src:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pg0KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDE4LjEuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPg0KPHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJDYXBhXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4Ig0KCSB2aWV3Qm94PSIwIDAgNDMuNzIzIDQzLjcyMyIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgNDMuNzIzIDQzLjcyMzsiIHhtbDpzcGFjZT0icHJlc2VydmUiPg0KPGc+DQoJPHBhdGggc3R5bGU9ImZpbGw6IzAzMDEwNDsiIGQ9Ik00My43MjMsMTQuNTcyaC02LjE2NmwtMC4zNTEsMy4zMjVjLTAuMTI5LTAuMDc4LTAuMjYxLTAuMTUzLTAuMzk3LTAuMjIydi02LjkzMw0KCQljMC0zLjA5MS0yLjUxNC01LjYwNS01LjYwNS01LjYwNUgxMi41MThjLTMuMDkyLDAtNS42MDUsMi41MTQtNS42MDUsNS42MDV2Ni45MzNjLTAuMTM4LDAuMDY3LTAuMjcxLDAuMTQ0LTAuMzk3LDAuMjIyDQoJCWwtMC4zNTEtMy4zMjVIMHYzLjE3N2w2LjE5OSwwLjM1NGMtMS4xNiwwLjgyMi0xLjkwMiwyLjA3Mi0xLjkwMiwzLjQ3N3Y2LjM1NGMwLDEuNTgsMC45MzksMi45NjcsMi4zNTUsMy43NjV2NC4yNzENCgkJYzAsMS40NDMsMS42OCwyLjYxNiwzLjc0OSwyLjYxNnMzLjc0OS0xLjE3MiwzLjc0OS0yLjYxNnYtMy41NWgxNC43OHYzLjU1YzAsMS40NDMsMS42NzgsMi42MTYsMy43NDgsMi42MTYNCgkJYzIuMDcxLDAsMy43NDgtMS4xNzIsMy43NDgtMi42MTZ2LTMuOTYyYzEuNzctMC43MDksMy0yLjI2NCwzLTQuMDcydi02LjM1NGMwLTEuNDA0LTAuNzQ0LTIuNjU0LTEuOTAzLTMuNDc3bDYuMi0wLjM1NA0KCQlMNDMuNzIzLDE0LjU3Mkw0My43MjMsMTQuNTcyeiBNOS4xNTQsMTAuNzQyYzAtMS44NTUsMS41MDktMy4zNjQsMy4zNjItMy4zNjRoMTguNjg3YzEuODU0LDAsMy4zNjQsMS41MDksMy4zNjQsMy4zNjR2Ni4zNjUNCgkJYy0wLjA5Ni0wLjAwNS0wLjE4OC0wLjAxMy0wLjI4My0wLjAxM0g5LjQzOGMtMC4wOTcsMC0wLjE4OSwwLjAwOC0wLjI4MywwLjAxM0w5LjE1NCwxMC43NDJMOS4xNTQsMTAuNzQyeiBNMjguMDI3LDI1LjMxN3YxLjQ5NA0KCQlIMTYuNDQydi0xLjQ5NEgyOC4wMjd6IE04LjAzMywyNy40NDZ2LTQuOTEzaDYuNzY2djQuOTEzSDguMDMzeiBNMTUuNjk0LDMxLjExYy0wLjUxOSwwLTAuOTM3LTAuNDE4LTAuOTM3LTAuOTM2DQoJCWMwLTAuNTE3LDAuNDE4LTAuOTM1LDAuOTM3LTAuOTM1YzAuNTE3LDAsMC45MzQsMC40MTgsMC45MzQsMC45MzVTMTYuMjExLDMxLjExLDE1LjY5NCwzMS4xMXogTTI4Ljk2MSwzMS4xMQ0KCQljLTAuNTE3LDAtMC45MzQtMC40MTgtMC45MzQtMC45MzZjMC0wLjUxNywwLjQxNy0wLjkzNSwwLjkzNC0wLjkzNXMwLjkzNiwwLjQxOCwwLjkzNiwwLjkzNQ0KCQlDMjkuODk2LDMwLjY5MSwyOS40NzgsMzEuMTEsMjguOTYxLDMxLjExeiBNMzYuNjIzLDI3LjQ0NmgtNi43NjZ2LTQuOTEzaDYuNzY2VjI3LjQ0NnoiLz4NCjwvZz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjwvc3ZnPg0K"})}),Object(re.jsxs)("div",{className:"centerContentCar",children:[Object(re.jsx)("div",{className:"nameCar",children:"".concat(t," ").concat(n)}),Object(re.jsx)("div",{className:"colorCar",children:c})]}),Object(re.jsxs)("div",{className:"distance",children:[r," \u043c"]})]})},le=function(e){var t=e.coords,n=e.noAdress,r=e.car,a=e.search,s=e.setSearch,u=e.carStatus,i=e.error,j=Object(c.useState)(),M=Object(ee.a)(j,2),d=M[0],l=M[1],b=Object(c.useState)(),O=Object(ee.a)(b,2),h=O[0],L=O[1],x=Object(o.c)(),w=Object(c.useRef)(null),f=r.map((function(e){var n=d.coordSystem.geo.getDistance(t,e.coords_car).toFixed();return e.distance=n,e}));f=f.sort((function(e,t){return e.distance>t.distance?1:-1})),f=u?Object(re.jsx)(Me,{}):f.map((function(e){return Object(re.jsx)(de,Object(N.a)({},e))}));var y=function(e){return w.current&&w.current.addEventListener("click",e)},g={search:a,submit:y,setSearch:s,noAdress:n};Object(c.useEffect)((function(){return d&&h.geoObjects.removeAll()&&x({type:"SEARCH_CAR"})&&ue(h,d,"i",t)}),[t]),Object(c.useEffect)((function(){return w&&w.current?function(){return w.current.removeEventListener("click",y)}:void 0})),Object(c.useEffect)((function(){return r.forEach((function(e){return ue(h,d,"car",e.coords_car)}))}),[r]);var p={width:"100%",height:300,defaultState:{center:[55.75,37.57],zoom:9},onLoad:function(e){return l(e)},onClick:function(e){return x({type:"CLICK_SEARCH_ADRESS",data:e.get("coords")})},instanceRef:function(e){return L(e)},modules:["geocode","GeoObject","Placemark","GeoObjectCollection","templateLayoutFactory","layout.ImageWithContent","formatter","coordSystem.geo"]};return Object(re.jsxs)("div",{className:"App",children:[Object(re.jsx)("div",{className:"form",children:Object(re.jsx)(oe,Object(N.a)({},g))}),Object(re.jsxs)("div",{className:"bodyApp",children:[Object(re.jsx)(te.b,{query:{apikey:"505379b1-6f2a-446f-af46-102586018d6a"},children:Object(re.jsx)("div",{className:"map",children:Object(re.jsx)(te.a,Object(N.a)({},p))})}),Object(re.jsx)("div",{className:"listCar",children:f})]}),Object(re.jsx)("div",{className:"submit",children:Object(re.jsx)("button",{ref:w,disabled:n||i,children:"\u0417\u0430\u043a\u0430\u0437\u0430\u0442\u044c"})})]})},be=Object(o.b)((function(e){var t=e.mainPage;return{search:t.inputSearch,coords:t.coords,noAdress:t.noAdress,error:t.error,car:t.car,carStatus:t.searchCarStatus}}),{setCoords:z,setSearch:function(e){return{type:L,body:e}},setSearchWithClick:C})(le);s.a.render(Object(re.jsx)(r.a.StrictMode,{children:Object(re.jsx)(o.a,{store:$,children:Object(re.jsx)(be,{})})}),document.getElementById("root")),q()}},[[48,1,2]]]);
//# sourceMappingURL=main.ad39f906.chunk.js.map